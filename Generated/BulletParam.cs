using System.Collections.Generic;
using System.Linq;
using SoulsFormats;

namespace EldenRingDataExtractor
{
	public class BulletParam
	{
		private readonly PARAM _param;
		public BulletParam(PARAM param) => _param = param;
		public IEnumerable<BulletParamRow> Entries => _param.Rows.Select(r => new BulletParamRow(r));
	}
	public class BulletParamRow
	{
		private readonly PARAM.Row _row;
		public BulletParamRow(PARAM.Row row) => _row = row;
		public int ID => _row.ID;
		public string Name => _row.Name;
		public int atkId_Bullet => (int)_row["atkId_Bullet"].Value;
		public int sfxId_Bullet => (int)_row["sfxId_Bullet"].Value;
		public int sfxId_Hit => (int)_row["sfxId_Hit"].Value;
		public int sfxId_Flick => (int)_row["sfxId_Flick"].Value;
		public float life => (float)_row["life"].Value;
		public float dist => (float)_row["dist"].Value;
		public float shootInterval => (float)_row["shootInterval"].Value;
		public float gravityInRange => (float)_row["gravityInRange"].Value;
		public float gravityOutRange => (float)_row["gravityOutRange"].Value;
		public float hormingStopRange => (float)_row["hormingStopRange"].Value;
		public float initVellocity => (float)_row["initVellocity"].Value;
		public float accelInRange => (float)_row["accelInRange"].Value;
		public float accelOutRange => (float)_row["accelOutRange"].Value;
		public float maxVellocity => (float)_row["maxVellocity"].Value;
		public float minVellocity => (float)_row["minVellocity"].Value;
		public float accelTime => (float)_row["accelTime"].Value;
		public float homingBeginDist => (float)_row["homingBeginDist"].Value;
		public float hitRadius => (float)_row["hitRadius"].Value;
		public float hitRadiusMax => (float)_row["hitRadiusMax"].Value;
		public float spreadTime => (float)_row["spreadTime"].Value;
		public float expDelay => (float)_row["expDelay"].Value;
		public float hormingOffsetRange => (float)_row["hormingOffsetRange"].Value;
		public float dmgHitRecordLifeTime => (float)_row["dmgHitRecordLifeTime"].Value;
		public float externalForce => (float)_row["externalForce"].Value;
		public int spEffectIDForShooter => (int)_row["spEffectIDForShooter"].Value;
		public int autoSearchNPCThinkID => (int)_row["autoSearchNPCThinkID"].Value;
		public int HitBulletID => (int)_row["HitBulletID"].Value;
		public int spEffectId0 => (int)_row["spEffectId0"].Value;
		public int spEffectId1 => (int)_row["spEffectId1"].Value;
		public int spEffectId2 => (int)_row["spEffectId2"].Value;
		public int spEffectId3 => (int)_row["spEffectId3"].Value;
		public int spEffectId4 => (int)_row["spEffectId4"].Value;
		public ushort numShoot => (ushort)_row["numShoot"].Value;
		public short homingAngle => (short)_row["homingAngle"].Value;
		public short shootAngle => (short)_row["shootAngle"].Value;
		public short shootAngleInterval => (short)_row["shootAngleInterval"].Value;
		public short shootAngleXInterval => (short)_row["shootAngleXInterval"].Value;
		public sbyte damageDamp => (sbyte)_row["damageDamp"].Value;
		public sbyte spelDamageDamp => (sbyte)_row["spelDamageDamp"].Value;
		public sbyte fireDamageDamp => (sbyte)_row["fireDamageDamp"].Value;
		public sbyte thunderDamageDamp => (sbyte)_row["thunderDamageDamp"].Value;
		public sbyte staminaDamp => (sbyte)_row["staminaDamp"].Value;
		public sbyte knockbackDamp => (sbyte)_row["knockbackDamp"].Value;
		public sbyte shootAngleXZ => (sbyte)_row["shootAngleXZ"].Value;
		public byte lockShootLimitAng => (byte)_row["lockShootLimitAng"].Value;
		public byte[] pad2 => (byte[])_row["pad2"].Value;
		public byte prevVelocityDirRate => (byte)_row["prevVelocityDirRate"].Value;
		public byte[] atkAttribute => (byte[])_row["atkAttribute"].Value;
		public byte[] spAttribute => (byte[])_row["spAttribute"].Value;
		public byte[] Material_AttackType => (byte[])_row["Material_AttackType"].Value;
		public byte[] Material_AttackMaterial => (byte[])_row["Material_AttackMaterial"].Value;
		public byte[] isPenetrateChr => (byte[])_row["isPenetrateChr"].Value;
		public byte[] isPenetrateObj => (byte[])_row["isPenetrateObj"].Value;
		public byte[] pad => (byte[])_row["pad"].Value;
		public byte[] launchConditionType => (byte[])_row["launchConditionType"].Value;
		public byte[] FollowType => (byte[])_row["FollowType"].Value;
		public byte[] EmittePosType => (byte[])_row["EmittePosType"].Value;
		public byte[] isAttackSFX => (byte[])_row["isAttackSFX"].Value;
		public byte[] isEndlessHit => (byte[])_row["isEndlessHit"].Value;
		public byte[] isPenetrateMap => (byte[])_row["isPenetrateMap"].Value;
		public byte[] isHitBothTeam => (byte[])_row["isHitBothTeam"].Value;
		public byte[] isUseSharedHitList => (byte[])_row["isUseSharedHitList"].Value;
		public byte[] isUseMultiDmyPolyIfPlace => (byte[])_row["isUseMultiDmyPolyIfPlace"].Value;
		public byte isHitOtherBulletForceEraseA => (byte)_row["isHitOtherBulletForceEraseA"].Value;
		public byte isHitOtherBulletForceEraseB => (byte)_row["isHitOtherBulletForceEraseB"].Value;
		public byte isHitForceMagic => (byte)_row["isHitForceMagic"].Value;
		public byte isIgnoreSfxIfHitWater => (byte)_row["isIgnoreSfxIfHitWater"].Value;
		public byte isIgnoreMoveStateIfHitWater => (byte)_row["isIgnoreMoveStateIfHitWater"].Value;
		public byte isHitDarkForceMagic => (byte)_row["isHitDarkForceMagic"].Value;
		public byte[] dmgCalcSide => (byte[])_row["dmgCalcSide"].Value;
		public byte[] isEnableAutoHoming => (byte[])_row["isEnableAutoHoming"].Value;
		public byte[] isSyncBulletCulcDumypolyPos => (byte[])_row["isSyncBulletCulcDumypolyPos"].Value;
		public byte[] isOwnerOverrideInitAngle => (byte[])_row["isOwnerOverrideInitAngle"].Value;
		public byte[] isInheritSfxToChild => (byte[])_row["isInheritSfxToChild"].Value;
		public sbyte darkDamageDamp => (sbyte)_row["darkDamageDamp"].Value;
		public byte[] bulletSfxDeleteType_byHit => (byte[])_row["bulletSfxDeleteType_byHit"].Value;
		public byte[] bulletSfxDeleteType_byLifeDead => (byte[])_row["bulletSfxDeleteType_byLifeDead"].Value;
		public float targetYOffsetRange => (float)_row["targetYOffsetRange"].Value;
		public float shootAngleYMaxRandom => (float)_row["shootAngleYMaxRandom"].Value;
		public float shootAngleXMaxRandom => (float)_row["shootAngleXMaxRandom"].Value;
		public int intervalCreateBulletId => (int)_row["intervalCreateBulletId"].Value;
		public float intervalCreateTimeMin => (float)_row["intervalCreateTimeMin"].Value;
		public float intervalCreateTimeMax => (float)_row["intervalCreateTimeMax"].Value;
		public float predictionShootObserveTime => (float)_row["predictionShootObserveTime"].Value;
		public float intervalCreateWaitTime => (float)_row["intervalCreateWaitTime"].Value;
		public byte[] sfxPostureType => (byte[])_row["sfxPostureType"].Value;
		public byte createLimitGroupId => (byte)_row["createLimitGroupId"].Value;
		public byte[] pad5 => (byte[])_row["pad5"].Value;
		public byte[] isInheritSpeedToChild => (byte[])_row["isInheritSpeedToChild"].Value;
		public byte[] isDisableHitSfx_byChrAndObj => (byte[])_row["isDisableHitSfx_byChrAndObj"].Value;
		public byte[] isCheckWall_byCenterRay => (byte[])_row["isCheckWall_byCenterRay"].Value;
		public byte isHitFlare => (byte)_row["isHitFlare"].Value;
		public byte[] isUseBulletWallFilter => (byte[])_row["isUseBulletWallFilter"].Value;
		public byte[] pad1 => (byte[])_row["pad1"].Value;
		public byte[] isNonDependenceMagicForFunnleNum => (byte[])_row["isNonDependenceMagicForFunnleNum"].Value;
		public byte[] isAiInterruptShootNoDamageBullet => (byte[])_row["isAiInterruptShootNoDamageBullet"].Value;
		public float randomCreateRadius => (float)_row["randomCreateRadius"].Value;
		public float followOffset_BaseHeight => (float)_row["followOffset_BaseHeight"].Value;
		public int assetNo_Hit => (int)_row["assetNo_Hit"].Value;
		public float lifeRandomRange => (float)_row["lifeRandomRange"].Value;
		public short homingAngleX => (short)_row["homingAngleX"].Value;
		public byte[] ballisticCalcType => (byte[])_row["ballisticCalcType"].Value;
		public byte[] attachEffectType => (byte[])_row["attachEffectType"].Value;
		public int seId_Bullet1 => (int)_row["seId_Bullet1"].Value;
		public int seId_Bullet2 => (int)_row["seId_Bullet2"].Value;
		public int seId_Hit => (int)_row["seId_Hit"].Value;
		public int seId_Flick => (int)_row["seId_Flick"].Value;
		public short howitzerShootAngleXMin => (short)_row["howitzerShootAngleXMin"].Value;
		public short howitzerShootAngleXMax => (short)_row["howitzerShootAngleXMax"].Value;
		public float howitzerInitMinVelocity => (float)_row["howitzerInitMinVelocity"].Value;
		public float howitzerInitMaxVelocity => (float)_row["howitzerInitMaxVelocity"].Value;
		public int sfxId_ForceErase => (int)_row["sfxId_ForceErase"].Value;
		public byte[] bulletSfxDeleteType_byForceErase => (byte[])_row["bulletSfxDeleteType_byForceErase"].Value;
		public byte[] pad3 => (byte[])_row["pad3"].Value;
		public short followDmypoly_forSfxPose => (short)_row["followDmypoly_forSfxPose"].Value;
		public float followOffset_Radius => (float)_row["followOffset_Radius"].Value;
		public float spBulletDistUpRate => (float)_row["spBulletDistUpRate"].Value;
		public float nolockTargetDist => (float)_row["nolockTargetDist"].Value;
		public byte[] pad4 => (byte[])_row["pad4"].Value;
		public override string ToString() => $"ID: {ID} | Name: {Name} | atkId_Bullet: {atkId_Bullet} | sfxId_Bullet: {sfxId_Bullet} | sfxId_Hit: {sfxId_Hit} | sfxId_Flick: {sfxId_Flick} | life: {life} | dist: {dist} | shootInterval: {shootInterval} | gravityInRange: {gravityInRange} | gravityOutRange: {gravityOutRange} | hormingStopRange: {hormingStopRange} | initVellocity: {initVellocity} | accelInRange: {accelInRange} | accelOutRange: {accelOutRange} | maxVellocity: {maxVellocity} | minVellocity: {minVellocity} | accelTime: {accelTime} | homingBeginDist: {homingBeginDist} | hitRadius: {hitRadius} | hitRadiusMax: {hitRadiusMax} | spreadTime: {spreadTime} | expDelay: {expDelay} | hormingOffsetRange: {hormingOffsetRange} | dmgHitRecordLifeTime: {dmgHitRecordLifeTime} | externalForce: {externalForce} | spEffectIDForShooter: {spEffectIDForShooter} | autoSearchNPCThinkID: {autoSearchNPCThinkID} | HitBulletID: {HitBulletID} | spEffectId0: {spEffectId0} | spEffectId1: {spEffectId1} | spEffectId2: {spEffectId2} | spEffectId3: {spEffectId3} | spEffectId4: {spEffectId4} | numShoot: {numShoot} | homingAngle: {homingAngle} | shootAngle: {shootAngle} | shootAngleInterval: {shootAngleInterval} | shootAngleXInterval: {shootAngleXInterval} | damageDamp: {damageDamp} | spelDamageDamp: {spelDamageDamp} | fireDamageDamp: {fireDamageDamp} | thunderDamageDamp: {thunderDamageDamp} | staminaDamp: {staminaDamp} | knockbackDamp: {knockbackDamp} | shootAngleXZ: {shootAngleXZ} | lockShootLimitAng: {lockShootLimitAng} | prevVelocityDirRate: {prevVelocityDirRate} | isHitOtherBulletForceEraseA: {isHitOtherBulletForceEraseA} | isHitOtherBulletForceEraseB: {isHitOtherBulletForceEraseB} | isHitForceMagic: {isHitForceMagic} | isIgnoreSfxIfHitWater: {isIgnoreSfxIfHitWater} | isIgnoreMoveStateIfHitWater: {isIgnoreMoveStateIfHitWater} | isHitDarkForceMagic: {isHitDarkForceMagic} | darkDamageDamp: {darkDamageDamp} | targetYOffsetRange: {targetYOffsetRange} | shootAngleYMaxRandom: {shootAngleYMaxRandom} | shootAngleXMaxRandom: {shootAngleXMaxRandom} | intervalCreateBulletId: {intervalCreateBulletId} | intervalCreateTimeMin: {intervalCreateTimeMin} | intervalCreateTimeMax: {intervalCreateTimeMax} | predictionShootObserveTime: {predictionShootObserveTime} | intervalCreateWaitTime: {intervalCreateWaitTime} | createLimitGroupId: {createLimitGroupId} | isHitFlare: {isHitFlare} | randomCreateRadius: {randomCreateRadius} | followOffset_BaseHeight: {followOffset_BaseHeight} | assetNo_Hit: {assetNo_Hit} | lifeRandomRange: {lifeRandomRange} | homingAngleX: {homingAngleX} | seId_Bullet1: {seId_Bullet1} | seId_Bullet2: {seId_Bullet2} | seId_Hit: {seId_Hit} | seId_Flick: {seId_Flick} | howitzerShootAngleXMin: {howitzerShootAngleXMin} | howitzerShootAngleXMax: {howitzerShootAngleXMax} | howitzerInitMinVelocity: {howitzerInitMinVelocity} | howitzerInitMaxVelocity: {howitzerInitMaxVelocity} | sfxId_ForceErase: {sfxId_ForceErase} | followDmypoly_forSfxPose: {followDmypoly_forSfxPose} | followOffset_Radius: {followOffset_Radius} | spBulletDistUpRate: {spBulletDistUpRate} | nolockTargetDist: {nolockTargetDist}";
	}
}
